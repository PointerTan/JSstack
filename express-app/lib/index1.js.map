{"version":3,"sources":["../src/index1.js"],"names":[],"mappings":";;;;;;kBAEe,YAAY;;AAEvB,QAAM,MAAM,SAAN,GAAM,CAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AAClC,YAAI,GAAJ,GAAU,GAAV;AACA,YAAI,GAAJ,GAAU,GAAV;AACA;AACA,YAAI,IAAJ,EAAU;AACN;AACH,SAFD,MAGK;AACD,gBAAI,IAAJ;AACH;AACD;AACA;AACA;AACH,KAbD;;AAeA,QAAI,KAAJ,GAAY,CAAZ;;AAEA,QAAI,IAAJ,GAAW,UAAU,KAAV,EAAiB;AACxB,YAAI,IAAI,KAAJ,CAAU,MAAV,KAAqB,CAAzB,EAA4B;AACxB,gBAAI,IAAI,MAAR,EAAgB;AACZ,oBAAI,MAAJ,CAAW,IAAI,GAAf,EAAoB,IAAI,GAAxB;AACH;;AAED,gBAAI,KAAJ,EAAW;AACP,oBAAI,GAAJ,CAAQ,UAAR,GAAqB,GAArB;AACA,oBAAI,GAAJ,CAAQ,GAAR,CAAY,WAAZ;AACH;;AAED,gBAAI,GAAJ,CAAQ,UAAR,GAAqB,GAArB;AACA,gBAAI,GAAJ,CAAQ,GAAR,CAAY,WAAZ;AACH,SAZD,MAaK;AACD,oBAAQ,GAAR,CAAY,aAAa,IAAI,KAAJ,CAAU,MAAnC;AACA,gBAAI,qBAAJ;;AAEA,gBAAI,YAAY,CAAhB;AACA,gBAAI,KAAJ,EAAW;AACP,4BAAY,CAAZ;AACH;;AAED,oBAAQ,GAAR,CAAY,gBAAgB,SAA5B;AACA;AACA;AACA;;AAEA,eAAG;AACC,+BAAe,IAAI,KAAJ,CAAU,CAAV,CAAf;AACA,oBAAI,KAAJ,CAAU,KAAV;AAGH,aALD,QAKS,aAAa,MAAb,KAAwB,SALjC;;AAOA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA,gBAAI;AACA,oBAAI,KAAJ,EAAW;AACP,iCAAa,KAAb,EAAoB,IAAI,GAAxB,EAA6B,IAAI,GAAjC,EAAsC,IAAI,IAA1C;AACH,iBAFD,MAGK;AACD,iCAAa,IAAI,GAAjB,EAAsB,IAAI,GAA1B,EAA+B,IAAI,IAAnC;AACH;AACJ,aAPD,CAOE,OAAO,KAAP,EAAc;AACZ,oBAAI,GAAJ,CAAQ,UAAR,GAAqB,GAArB;AACA,oBAAI,GAAJ,CAAQ,GAAR,CAAY,WAAZ;AACH;AACJ;AACJ,KA3DD;;AA6DA,QAAI,MAAJ,GAAa,YAAY;AACrB,YAAM,SAAS,eAAK,YAAL,CAAkB,GAAlB,CAAf;AACA,eAAO,MAAP,CAAc,IAAd;AACH,KAHD;;AAKA,QAAI,KAAJ,GAAY,EAAZ;;AAEA,QAAI,GAAJ,GAAU,UAAU,QAAV,EAAoB;AAC1B,iBAAS,MAAT,GAAkB,GAAlB;AACA,YAAI,KAAJ,CAAU,IAAV,CAAe,QAAf;AACH,KAHD;;AAKA,WAAO,GAAP;AACH,C;;AA/FD","file":"index1.js","sourcesContent":["import http from \"http\";\n\nexport default function () {\n\n    const app = function (req, res, next) {\n        app.req = req;\n        app.res = res;\n        // app.fatherNext = next;\n        if (next) {\n            next();\n        }\n        else {\n            app.next();\n        }\n        // res.writeHead(200, { 'Content-Type': 'text/plain' });\n        // res.statusCode = 404;\n        // res.end(\"not found\");\n    }\n\n    app.isApp = 1;\n\n    app.next = function (error) {\n        if (app.stack.length === 0) {\n            if (app.father) {\n                app.father(app.req, app.res);\n            }\n\n            if (error) {\n                app.res.statusCode = 500;\n                app.res.end(\"get error\");\n            }\n\n            app.res.statusCode = 404;\n            app.res.end(\"not found\");\n        }\n        else {\n            console.log(\"length :\" + app.stack.length);\n            let handleMethod;\n\n            let argLength = 3;\n            if (error) {\n                argLength = 4;\n            }\n\n            console.log(\"argLength: \" + argLength);\n            // if (handleMethod.isApp === 1) {\n            //     argLength = 2;\n            // }\n\n            do {\n                handleMethod = app.stack[0];\n                app.stack.shift();\n\n\n            } while (handleMethod.length !== argLength);\n\n            // console.log(\"func :\" + handleMethod);\n            // if (handleMethod === undefined) {\n            //     if (error) {\n            //         app.res.statusCode = 500;\n            //         app.res.end(\"get error\");\n            //     }\n\n            //     app.res.statusCode = 404;\n            //     app.res.end(\"not found\");\n            // }\n\n\n            try {\n                if (error) {\n                    handleMethod(error, app.req, app.res, app.next);\n                }\n                else {\n                    handleMethod(app.req, app.res, app.next);\n                }\n            } catch (error) {\n                app.res.statusCode = 500;\n                app.res.end(\"get error\");\n            }\n        }\n    }\n\n    app.listen = function () {\n        const server = http.createServer(app);\n        server.listen(4000);\n    }\n\n    app.stack = [];\n\n    app.use = function (nextFunc) {\n        nextFunc.father = app;\n        app.stack.push(nextFunc);\n    }\n\n    return app;\n}"]}